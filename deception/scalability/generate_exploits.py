# -*- coding: utf-8 -*-
"""
Created on Wed May  5 23:12:52 2021

@author: Junlin
"""

import numpy as np
import pickle

#num_e = 40
#dim = 40 #dim has to be an even number

for dim in range(20,101,10):
    exploit_list = []
    num_e = dim
    for i in range(num_e):
        rand_idx = np.random.randint(0, int(dim/2), 1)[0]
        #generate the port index that has to open
        port_index = np.random.randint(0, int(dim/2), 1)[0]
        port_list = [[-1,1,0,0]]*int((dim/2))
        #limit a port has to open
        port_list[port_index] = [1,0,0,0]
        
        sys_app_list = [[-1,1,2,3]]*int((dim/2))
        config_list = sys_app_list + port_list
        #exploit just target system + port
        if rand_idx < 3:
            #limit system versions
            version_range = np.random.randint(1, 4, 2)
            version_list = list(range(min(version_range),max(version_range)+1))
            version_list = version_list + [0]*(4-len(version_list))
            config_list[rand_idx] = version_list
        else:
            #limit app versions
            version_range = np.random.randint(1, 4, 2)
            version_list = list(range(min(version_range),max(version_range)+1))
            version_list = version_list + [0]*(4-len(version_list))
            config_list[rand_idx] = version_list
            #limit system versions
            sys_idx = np.random.randint(0, 3, 1)[0]
            version_range = np.random.randint(1, 4, 2)
            version_list = list(range(min(version_range),max(version_range)+1))
            version_list = version_list + [0]*(4-len(version_list))
            config_list[sys_idx] = version_list
    
        exploit_list = exploit_list + [config_list]
    
    
    f = open('exploit_'+str(dim) + '_bm.pckl', 'wb')
    pickle.dump(exploit_list, f)
    f.close()